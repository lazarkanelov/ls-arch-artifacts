{
  "hash": "12a2e723c7476f59",
  "source_url": "https://registry.terraform.io/modules/justtrackio/sqs/aws/1.9.0",
  "source_type": "terraform_registry",
  "discovered_at": "2026-01-11T21:33:13.738780",
  "services": [
    "sns",
    "cloudwatch"
  ],
  "resource_count": 3,
  "name": "justtrackio/sqs",
  "description": "Terraform module which creates a sqs queue",
  "version": "1.9.0",
  "skipped": false,
  "skip_reason": null,
  "original_format": null,
  "terraform_files": {
    "cloudwatch.tf": "locals {\n  alarm_description     = var.alarm.description != null ? var.alarm.description : \"SQS Queue Metrics: https://${module.this.aws_region}.console.aws.amazon.com/sqs/v2/home?region=${module.this.aws_region}#/queues/https%3A%2F%2Fsqs.${module.this.aws_region}.amazonaws.com%2F${module.this.aws_account_id}%2F${module.sqs.queue_name}\"\n  alarm_topic_arn       = var.alarm_topic_arn != null ? var.alarm_topic_arn : \"arn:aws:sns:${module.this.aws_region}:${module.this.aws_account_id}:${module.this.environment}-alarms\"\n  dlq_alarm_enabled     = var.alarm_enabled && var.dlq_alarm_enabled\n  dlq_alarm_description = var.dlq_alarm.description != null ? var.dlq_alarm.description : (var.dlq_enabled ? \"SQS Queue Metrics: https://${module.this.aws_region}.console.aws.amazon.com/sqs/v2/home?region=${module.this.aws_region}#/queues/https%3A%2F%2Fsqs.${module.this.aws_region}.amazonaws.com%2F${module.this.aws_account_id}%2F${module.sqs.dead_letter_queue_name}\" : \"\")\n}\n\nresource \"aws_cloudwatch_metric_alarm\" \"backlog\" {\n  count = module.this.enabled && var.alarm_enabled ? 1 : 0\n\n  alarm_description = jsonencode(merge({\n    Priority    = var.alarm.priority\n    Description = local.alarm_description\n  }, module.this.tags, module.this.additional_tag_map))\n  alarm_name          = \"${module.sqs.queue_name}-backlog\"\n  comparison_operator = \"GreaterThanThreshold\"\n  datapoints_to_alarm = var.alarm.datapoints_to_alarm\n  evaluation_periods  = var.alarm.evaluation_periods\n  threshold           = var.alarm.threshold\n  treat_missing_data  = \"notBreaching\"\n\n  metric_query {\n    id          = \"visible\"\n    return_data = false\n\n    metric {\n      dimensions = {\n        QueueName = module.sqs.queue_name\n      }\n      metric_name = \"ApproximateNumberOfMessagesVisible\"\n      namespace   = \"AWS/SQS\"\n      period      = var.alarm.period\n      stat        = \"Sum\"\n    }\n  }\n\n  metric_query {\n    id          = \"incoming\"\n    return_data = false\n\n    metric {\n      dimensions = {\n        QueueName = module.sqs.queue_name\n      }\n      metric_name = \"NumberOfMessagesSent\"\n      namespace   = \"AWS/SQS\"\n      period      = var.alarm.period\n      stat        = \"Sum\"\n    }\n  }\n\n  metric_query {\n    id          = \"delayed\"\n    return_data = false\n\n    metric {\n      dimensions = {\n        QueueName = module.sqs.queue_name\n      }\n      metric_name = \"ApproximateNumberOfMessagesDelayed\"\n      namespace   = \"AWS/SQS\"\n      period      = var.alarm.period\n      stat        = \"Sum\"\n    }\n  }\n\n  metric_query {\n    id          = \"deleted\"\n    return_data = false\n\n    metric {\n      dimensions = {\n        QueueName = module.sqs.queue_name\n      }\n      metric_name = \"NumberOfMessagesDeleted\"\n      namespace   = \"AWS/SQS\"\n      period      = var.alarm.period\n      stat        = \"Sum\"\n    }\n  }\n\n  metric_query {\n    expression  = \"visible - delayed + incoming - (deleted * ${var.alarm.backlog_minutes})\"\n    id          = \"backlog\"\n    label       = \"visible - delayed + incoming - (deleted * ${var.alarm.backlog_minutes})\"\n    return_data = true\n  }\n\n  alarm_actions = [local.alarm_topic_arn]\n  ok_actions    = [local.alarm_topic_arn]\n\n  tags = module.this.tags\n}\n\nresource \"aws_cloudwatch_metric_alarm\" \"dlq_backlog\" {\n  count = module.this.enabled && local.dlq_alarm_enabled ? 1 : 0\n\n  alarm_description = jsonencode(merge({\n    Priority    = var.dlq_alarm.priority\n    Description = local.dlq_alarm_description\n  }, module.this.tags, module.this.additional_tag_map))\n  alarm_name          = \"${module.sqs.dead_letter_queue_name}-backlog\"\n  comparison_operator = \"GreaterThanThreshold\"\n  datapoints_to_alarm = var.dlq_alarm.datapoints_to_alarm\n  evaluation_periods  = var.dlq_alarm.evaluation_periods\n  threshold           = var.dlq_alarm.threshold\n  treat_missing_data  = \"notBreaching\"\n\n  metric_query {\n    id          = \"visible\"\n    return_data = true\n\n    metric {\n      dimensions = {\n        QueueName = module.sqs.dead_letter_queue_name\n      }\n      metric_name = \"ApproximateNumberOfMessagesVisible\"\n      namespace   = \"AWS/SQS\"\n      period      = var.dlq_alarm.period\n      stat        = \"Average\"\n    }\n  }\n\n  alarm_actions = [local.alarm_topic_arn]\n  ok_actions    = [local.alarm_topic_arn]\n\n  tags = module.this.tags\n}\n",
    "context.tf": "#\n# ONLY EDIT THIS FILE IN github.com/justtrackio/terraform-null-label\n# All other instances of this file should be a copy of that one\n#\n#\n# Copy this file from https://github.com/justtrackio/terraform-null-label/blob/main/exports/context.tf\n# and then place it in your Terraform module to automatically get\n# justtrack's standard configuration inputs suitable for passing\n# to justtrack modules.\n#\n# curl -sL https://raw.githubusercontent.com/justtrackio/terraform-null-label/main/exports/context.tf -o context.tf\n#\n# Modules should access the whole context as `module.this.context`\n# to get the input variables with nulls for defaults,\n# for example `context = module.this.context`,\n# and access individual variables as `module.this.<var>`,\n# with final values filled in.\n#\n# For example, when using defaults, `module.this.context.delimiter`\n# will be null, and `module.this.delimiter` will be `-` (hyphen).\n#\n\nmodule \"this\" {\n  source  = \"justtrackio/label/null\"\n  version = \"0.26.0\" # requires Terraform >= 0.13.0\n\n  enabled             = var.enabled\n  namespace           = var.namespace\n  tenant              = var.tenant\n  environment         = var.environment\n  stage               = var.stage\n  name                = var.name\n  delimiter           = var.delimiter\n  attributes          = var.attributes\n  tags                = var.tags\n  additional_tag_map  = var.additional_tag_map\n  label_order         = var.label_order\n  regex_replace_chars = var.regex_replace_chars\n  id_length_limit     = var.id_length_limit\n  label_key_case      = var.label_key_case\n  label_value_case    = var.label_value_case\n  descriptor_formats  = var.descriptor_formats\n  labels_as_tags      = var.labels_as_tags\n  aws_account_id      = var.aws_account_id\n  aws_region          = var.aws_region\n  organizational_unit = var.organizational_unit\n\n  context = var.context\n}\n\n# Copy contents of justtrackio/terraform-null-label/variables.tf here\n\nvariable \"context\" { # tflint-ignore: terraform_standard_module_structure\n  type = any\n  default = {\n    enabled             = true\n    namespace           = null\n    tenant              = null\n    environment         = null\n    stage               = null\n    name                = null\n    delimiter           = null\n    attributes          = []\n    tags                = {}\n    additional_tag_map  = {}\n    regex_replace_chars = null\n    label_order         = []\n    id_length_limit     = null\n    label_key_case      = null\n    label_value_case    = null\n    descriptor_formats  = {}\n    # Note: we have to use [] instead of null for unset lists due to\n    # https://github.com/hashicorp/terraform/issues/28137\n    # which was not fixed until Terraform 1.0.0,\n    # but we want the default to be all the labels in `label_order`\n    # and we want users to be able to prevent all tag generation\n    # by setting `labels_as_tags` to `[]`, so we need\n    # a different sentinel to indicate \"default\"\n    labels_as_tags = [\"unset\"]\n  }\n  description = <<-EOT\n    Single object for setting entire context at once.\n    See description of individual variables for details.\n    Leave string and numeric variables as `null` to use default value.\n    Individual variable settings (non-null) override settings in context object,\n    except for attributes, tags, and additional_tag_map, which are merged.\n  EOT\n\n  validation {\n    condition     = lookup(var.context, \"label_key_case\", null) == null ? true : contains([\"lower\", \"title\", \"upper\"], var.context[\"label_key_case\"])\n    error_message = \"Allowed values: `lower`, `title`, `upper`.\"\n  }\n\n  validation {\n    condition     = lookup(var.context, \"label_value_case\", null) == null ? true : contains([\"lower\", \"title\", \"upper\", \"none\"], var.context[\"label_value_case\"])\n    error_message = \"Allowed values: `lower`, `title`, `upper`, `none`.\"\n  }\n}\n\nvariable \"enabled\" { # tflint-ignore: terraform_standard_module_structure\n  type        = bool\n  default     = null\n  description = \"Set to false to prevent the module from creating any resources\"\n}\n\nvariable \"namespace\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  default     = null\n  description = \"ID element. Usually an abbreviation of your organization name, e.g. 'eg' or 'cp', to help ensure generated IDs are globally unique\"\n}\n\nvariable \"tenant\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  default     = null\n  description = \"ID element _(Rarely used, not included by default)_. A customer identifier, indicating who this instance of a resource is for\"\n}\n\nvariable \"environment\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  default     = null\n  description = \"ID element. Usually used for region e.g. 'uw2', 'us-west-2', OR role 'prod', 'staging', 'dev', 'UAT'\"\n}\n\nvariable \"stage\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  default     = null\n  description = \"ID element. Usually used to indicate role, e.g. 'prod', 'staging', 'source', 'build', 'test', 'deploy', 'release'\"\n}\n\nvariable \"name\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  default     = null\n  description = <<-EOT\n    ID element. Usually the component or solution name, e.g. 'app' or 'jenkins'.\n    This is the only ID element not also included as a `tag`.\n    The \"name\" tag is set to the full `id` string. There is no tag with the value of the `name` input.\n    EOT\n}\n\nvariable \"delimiter\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  default     = null\n  description = <<-EOT\n    Delimiter to be used between ID elements.\n    Defaults to `-` (hyphen). Set to `\"\"` to use no delimiter at all.\n  EOT\n}\n\nvariable \"attributes\" { # tflint-ignore: terraform_standard_module_structure\n  type        = list(string)\n  default     = []\n  description = <<-EOT\n    ID element. Additional attributes (e.g. `workers` or `cluster`) to add to `id`,\n    in the order they appear in the list. New attributes are appended to the\n    end of the list. The elements of the list are joined by the `delimiter`\n    and treated as a single ID element.\n    EOT\n}\n\nvariable \"labels_as_tags\" { # tflint-ignore: terraform_standard_module_structure\n  type        = set(string)\n  default     = [\"default\"]\n  description = <<-EOT\n    Set of labels (ID elements) to include as tags in the `tags` output.\n    Default is to include all labels.\n    Tags with empty values will not be included in the `tags` output.\n    Set to `[]` to suppress all generated tags.\n    **Notes:**\n      The value of the `name` tag, if included, will be the `id`, not the `name`.\n      Unlike other `null-label` inputs, the initial setting of `labels_as_tags` cannot be\n      changed in later chained modules. Attempts to change it will be silently ignored.\n    EOT\n}\n\nvariable \"tags\" { # tflint-ignore: terraform_standard_module_structure\n  type        = map(string)\n  default     = {}\n  description = <<-EOT\n    Additional tags (e.g. `{'BusinessUnit': 'XYZ'}`).\n    Neither the tag keys nor the tag values will be modified by this module.\n    EOT\n}\n\nvariable \"additional_tag_map\" { # tflint-ignore: terraform_standard_module_structure\n  type        = map(string)\n  default     = {}\n  description = <<-EOT\n    Additional key-value pairs to add to each map in `tags_as_list_of_maps`. Not added to `tags` or `id`.\n    This is for some rare cases where resources want additional configuration of tags\n    and therefore take a list of maps with tag key, value, and additional configuration.\n    EOT\n}\n\nvariable \"label_order\" { # tflint-ignore: terraform_standard_module_structure\n  type        = list(string)\n  default     = null\n  description = <<-EOT\n    The order in which the labels (ID elements) appear in the `id`.\n    Defaults to [\"namespace\", \"environment\", \"stage\", \"name\", \"attributes\"].\n    You can omit any of the 6 labels (\"tenant\" is the 6th), but at least one must be present.\n    EOT\n}\n\nvariable \"regex_replace_chars\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  default     = null\n  description = <<-EOT\n    Terraform regular expression (regex) string.\n    Characters matching the regex will be removed from the ID elements.\n    If not set, `\"/[^a-zA-Z0-9-]/\"` is used to remove all characters other than hyphens, letters and digits.\n  EOT\n}\n\nvariable \"id_length_limit\" { # tflint-ignore: terraform_standard_module_structure\n  type        = number\n  default     = null\n  description = <<-EOT\n    Limit `id` to this many characters (minimum 6).\n    Set to `0` for unlimited length.\n    Set to `null` for keep the existing setting, which defaults to `0`.\n    Does not affect `id_full`.\n  EOT\n  validation {\n    condition     = var.id_length_limit == null ? true : var.id_length_limit >= 6 || var.id_length_limit == 0\n    error_message = \"The id_length_limit must be >= 6 if supplied (not null), or 0 for unlimited length.\"\n  }\n}\n\nvariable \"label_key_case\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  default     = null\n  description = <<-EOT\n    Controls the letter case of the `tags` keys (label names) for tags generated by this module.\n    Does not affect keys of tags passed in via the `tags` input.\n    Possible values: `lower`, `title`, `upper`.\n    Default value: `title`.\n  EOT\n\n  validation {\n    condition     = var.label_key_case == null ? true : contains([\"lower\", \"title\", \"upper\"], var.label_key_case)\n    error_message = \"Allowed values: `lower`, `title`, `upper`.\"\n  }\n}\n\nvariable \"label_value_case\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  default     = null\n  description = <<-EOT\n    Controls the letter case of ID elements (labels) as included in `id`,\n    set as tag values, and output by this module individually.\n    Does not affect values of tags passed in via the `tags` input.\n    Possible values: `lower`, `title`, `upper` and `none` (no transformation).\n    Set this to `title` and set `delimiter` to `\"\"` to yield Pascal Case IDs.\n    Default value: `lower`.\n  EOT\n\n  validation {\n    condition     = var.label_value_case == null ? true : contains([\"lower\", \"title\", \"upper\", \"none\"], var.label_value_case)\n    error_message = \"Allowed values: `lower`, `title`, `upper`, `none`.\"\n  }\n}\n\nvariable \"descriptor_formats\" { # tflint-ignore: terraform_standard_module_structure\n  type        = any\n  default     = {}\n  description = <<-EOT\n    Describe additional descriptors to be output in the `descriptors` output map.\n    Map of maps. Keys are names of descriptors. Values are maps of the form\n    `{\n       format = string\n       labels = list(string)\n    }`\n    (Type is `any` so the map values can later be enhanced to provide additional options.)\n    `format` is a Terraform format string to be passed to the `format()` function.\n    `labels` is a list of labels, in order, to pass to `format()` function.\n    Label values will be normalized before being passed to `format()` so they will be\n    identical to how they appear in `id`.\n    Default is `{}` (`descriptors` output will be empty).\n    EOT\n}\n\nvariable \"aws_account_id\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  description = \"AWS account id\"\n  default     = null\n}\n\nvariable \"aws_region\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  description = \"AWS region\"\n  default     = null\n}\n\nvariable \"organizational_unit\" { # tflint-ignore: terraform_standard_module_structure\n  type        = string\n  description = \"Usually used to indicate the AWS organizational unit, e.g. 'prod', 'sdlc'\"\n  default     = null\n}\n\n#### End of copy of justtrackio/terraform-null-label/variables.tf\n",
    "main.tf": "data \"aws_iam_policy_document\" \"subscription\" {\n  count = length(var.subscription) >= 1 ? 1 : 0\n\n  statement {\n    actions = [\n      \"sqs:SendMessage\",\n      \"sqs:ReceiveMessage\",\n    ]\n\n    resources = [module.sqs.queue_arn]\n\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"*\"]\n    }\n\n    dynamic \"condition\" {\n      for_each = var.subscription\n      content {\n        test     = \"ArnEquals\"\n        values   = [for key in keys(aws_sns_topic_subscription.default) : aws_sns_topic_subscription.default[key].topic_arn]\n        variable = \"aws:SourceArn\"\n      }\n    }\n  }\n}\n\nmodule \"sqs\" {\n  source  = \"terraform-aws-modules/sqs/aws\"\n  version = \"4.2.0\"\n\n  create_dlq                = var.dlq_enabled\n  create_queue_policy       = length(var.subscription) >= 1\n  delay_seconds             = var.delay_seconds\n  dlq_name                  = var.dlq_name\n  fifo_queue                = var.fifo_queue\n  message_retention_seconds = var.message_retention_seconds\n  name                      = module.this.id\n  redrive_policy = var.dlq_enabled ? {\n    maxReceiveCount = var.dlq_max_receive_count\n  } : {}\n  source_queue_policy_documents = try([data.aws_iam_policy_document.subscription[0].json], [])\n  tags                          = module.this.tags\n  visibility_timeout_seconds    = var.visibility_timeout_seconds\n}\n\nresource \"aws_sns_topic_subscription\" \"default\" {\n  for_each                        = var.subscription\n  topic_arn                       = \"arn:aws:sns:${module.this.aws_region}:${each.value.aws_account_id != null ? each.value.aws_account_id : module.this.aws_account_id}:${each.value.topic_name}\"\n  confirmation_timeout_in_minutes = \"1\"\n  endpoint_auto_confirms          = \"false\"\n  protocol                        = \"sqs\"\n  endpoint                        = module.sqs.queue_arn\n  filter_policy                   = each.value.filter_policy\n}\n",
    "outputs.tf": "output \"sqs_queue_url\" {\n  value       = module.sqs.queue_url\n  description = \"queue url of the main sqs queue\"\n}\noutput \"sqs_queue_arn\" {\n  value       = module.sqs.queue_arn\n  description = \"queue arn of the main sqs queue\"\n}\n\noutput \"sqs_queue_name\" {\n  value       = module.sqs.queue_name\n  description = \"queue name of the main sqs queue\"\n}\n\noutput \"dlq_queue_url\" {\n  value       = module.sqs.dead_letter_queue_url\n  description = \"queue url of the dead letter sqs queue\"\n}\n\noutput \"dlq_queue_arn\" {\n  value       = module.sqs.dead_letter_queue_arn\n  description = \"queue arn of the dead letter sqs queue\"\n}\n\noutput \"dlq_queue_name\" {\n  value       = module.sqs.dead_letter_queue_name\n  description = \"queue name of the dead letter sqs queue\"\n}\n",
    "variables.tf": "variable \"alarm\" {\n  type = object({\n    backlog_minutes     = optional(number, 5)\n    datapoints_to_alarm = optional(number, 3)\n    description         = optional(string, null)\n    evaluation_periods  = optional(number, 3)\n    period              = optional(number, 60)\n    threshold           = optional(number, 0)\n    priority            = optional(string, \"warning\")\n  })\n  description = \"The details of the alarm such as datapoints to alarm, evaluation periods, backlog minutes, period, and threshold.\"\n  default     = {}\n}\n\nvariable \"alarm_enabled\" {\n  type        = bool\n  description = \"Defines if the alarm should be created.\"\n  default     = false\n}\n\nvariable \"alarm_topic_arn\" {\n  type        = string\n  description = \"The ARN of the SNS Topic used for notifying about alarm/ok messages.\"\n  default     = null\n}\n\nvariable \"delay_seconds\" {\n  description = \"The time in seconds that the delivery of all messages in the queue will be delayed. An integer from 0 to 900 (15 minutes)\"\n  type        = number\n  default     = null\n}\n\nvariable \"dlq_alarm\" {\n  type = object({\n    backlog_minutes     = optional(number, 5)\n    datapoints_to_alarm = optional(number, 3)\n    description         = optional(string, null)\n    evaluation_periods  = optional(number, 3)\n    period              = optional(number, 60)\n    threshold           = optional(number, 10)\n    priority            = optional(string, \"warning\")\n  })\n  description = \"The details of the DLQ alarm such as datapoints to alarm, evaluation periods, backlog minutes, period, and threshold.\"\n  default     = {}\n}\n\nvariable \"dlq_alarm_enabled\" {\n  type        = bool\n  description = \"Defines if the DLQ alarm should be created.\"\n  default     = true\n}\n\nvariable \"dlq_enabled\" {\n  type        = bool\n  description = \"Defines if Dead Letter Queue (DLQ) is enabled.\"\n  default     = true\n}\n\nvariable \"dlq_max_receive_count\" {\n  type        = number\n  description = \"The maximum number of times a message can be received from the DLQ before it's discarded.\"\n  default     = 5\n}\n\nvariable \"dlq_name\" {\n  type        = string\n  description = \"Sets a custom name for the to be created dlq.\"\n  default     = null\n}\n\nvariable \"fifo_queue\" {\n  type        = bool\n  description = \"Boolean designating a FIFO queue\"\n  default     = false\n}\n\nvariable \"message_retention_seconds\" {\n  description = \"The number of seconds Amazon SQS retains a message. Integer representing seconds, from 60 (1 minute) to 1209600 (14 days)\"\n  type        = number\n  default     = null\n}\n\nvariable \"subscription\" {\n  type = map(object({\n    aws_account_id = optional(string)\n    topic_name     = string\n    filter_policy  = optional(string)\n  }))\n  description = \"The subscription details such as topic name and filter policy.\"\n  default     = {}\n}\n\nvariable \"visibility_timeout_seconds\" {\n  description = \"The visibility timeout for the queue. An integer from 0 to 43200 (12 hours)\"\n  type        = number\n  default     = null\n}\n",
    "versions.tf": "terraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \">= 4.67\"\n    }\n  }\n  required_version = \">= 1.3.0\"\n}\n"
  }
}