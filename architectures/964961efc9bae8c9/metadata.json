{
  "hash": "964961efc9bae8c9",
  "source_url": "https://github.com/aws-quickstart/terraform-aws-ecs-fargate",
  "source_type": "github",
  "discovered_at": "2026-01-10T17:00:18.364533",
  "services": [
    "ecs",
    "iam",
    "ec2"
  ],
  "resource_count": 36,
  "name": "terraform-aws-ecs-fargate",
  "description": "AWS Quick Start Team",
  "version": null,
  "skipped": false,
  "skip_reason": null,
  "original_format": null,
  "terraform_files": {
    "deploy_Publicly_Exposed_Service_with_Private_Networking/main.tf": "# ----------------------------------------------------------------------------------------------------------------------\n# REQUIRE A SPECIFIC TERRAFORM VERSION OR HIGHER\n# This module has been updated with 0.12 syntax, which means it is no longer compatible with any versions below 0.12.\n# ----------------------------------------------------------------------------------------------------------------------\n######################################\n# Defaults\n######################################\nterraform {\n  required_version = \">= 0.13\"\n  \n   backend \"remote\" {}\n}\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nresource \"random_pet\" \"name\" {\n  prefix = \"aws-quickstart\"\n  length = 1\n}\n\n######################################\n# Create VPC\n######################################\n\nmodule \"quickstart_vpc\" {\n  source = \"../modules/quickstart_vpc\"\n  region = \"us-east-1\"\n  name   = \"${random_pet.name.id}\"\n  cidr     = \"10.0.0.0/16\"\n  public_subnets      = [\"10.0.0.0/24\", \"10.0.1.0/24\"]\n  private_subnets_A   = [\"10.0.2.0/24\", \"10.0.3.0/24\"]\n}\n\n######################################\n# Create Bastion host\n######################################\nmodule \"bastion\" {\n  depends_on = [module.quickstart_vpc]\n  source = \"../modules/bastion\"\n  create_bastion = false\n  region = \"us-east-1\"\n  name   = \"${random_pet.name.id}\"\n  key_name = \"\"\n}\n######################################\n# Create Fargate Managed ECS Cluster\n######################################\nmodule \"fargate\" {\n  depends_on = [module.quickstart_vpc]\n  source = \"../modules/fargate\"\n  region = \"us-east-1\"\n  name   = \"${random_pet.name.id}\"\n}\n\n",
    "deploy_Publicly_Exposed_Service_with_Private_Networking/outputs.tf": "output \"ssh_key\" {\n    value = module.bastion.private_key_pem\n}\n\n# VPC\noutput \"vpc_cidr\" {\n  description = \"VPC_CIDR \"\n  value       = module.quickstart_vpc.vpc_cidr\n}\noutput  \"vpc_id\" {\n  description = \"The ID of the VPC\"\n  value       = module.quickstart_vpc.vpc_id\n}\noutput \"NAT1EIP\" {\n    description = \"NAT 1 IP address\"\n    value = module.quickstart_vpc.NAT1EIP\n}\n\noutput \"NAT2EIP\" {\n    description = \" NAT 2 IP address\"\n    value =  module.quickstart_vpc.NAT2EIP\n  }\n\noutput \"NAT3EIP\" {\n    description = \" NAT 3 IP address\"\n    value =  module.quickstart_vpc.NAT3EIP\n  }\n\noutput \"NAT4EIP\" {\n    description = \" NAT 4 IP address\"\n    value = module.quickstart_vpc.NAT4EIP\n  }\n\noutput \"PrivateSubnet1ACIDR\" {\n    description = \" Private subnet 1A CIDR in Availability Zone 1\"\n    value = module.quickstart_vpc.PrivateSubnet1ACIDR\n  }\n\noutput \"PrivateSubnet1AID\" {\n    description = \" Private subnet 1A ID in Availability Zone 1\"\n    value = module.quickstart_vpc.PrivateSubnet1AID\n  }\n\noutput \"PrivateSubnet2ACIDR\" {\n    description = \" Private subnet 2A CIDR in Availability Zone 2\"\n    value = module.quickstart_vpc.PrivateSubnet2ACIDR\n  }\n\noutput \"PrivateSubnet2AID\" {\n    description = \" Private subnet 2A ID in Availability Zone 2\"\n    value = module.quickstart_vpc.PrivateSubnet2AID\n  }\n\noutput \"PrivateSubnet3ACIDR\" {\n    description = \" Private subnet 3A CIDR in Availability Zone 3\"\n    value = module.quickstart_vpc.PrivateSubnet3ACIDR\n  }\n\noutput \"PrivateSubnet3AID\" {\n    description = \" Private subnet 3A ID in Availability Zone 3\"\n    value = module.quickstart_vpc.PrivateSubnet3AID\n  }\n\noutput \"PrivateSubnet4ACIDR\" {\n    description = \" Private subnet 4A CIDR in Availability Zone 4\"\n    value = module.quickstart_vpc.PrivateSubnet4ACIDR\n  }\n\noutput \"PrivateSubnet4AID\" {\n    description = \" Private subnet 4A ID in Availability Zone 4\"\n    value = module.quickstart_vpc.PrivateSubnet4AID\n  }\n\noutput \"PublicSubnet1CIDR\" {\n    description = \" Public subnet 1 CIDR in Availability Zone 1\"\n    value = module.quickstart_vpc.PublicSubnet1CIDR\n  }\n\noutput \"PublicSubnet1ID\" {\n    description = \" Public subnet 1 ID in Availability Zone 1\"\n    value = module.quickstart_vpc.PublicSubnet1ID\n  }\n\noutput \"PublicSubnet2CIDR\" {\n    description = \" Public subnet 2 CIDR in Availability Zone 2\"\n    value =  module.quickstart_vpc.PublicSubnet2CIDR\n  }\n\noutput \"PublicSubnet2ID\" {\n    description = \" Public subnet 2 ID in Availability Zone 2\"\n    value = module.quickstart_vpc.PublicSubnet2ID\n  }\n\noutput \"PublicSubnet3CIDR\" {\n    description = \" Public subnet 3 CIDR in Availability Zone 3\"\n    value = module.quickstart_vpc.PublicSubnet3CIDR\n  }\n\noutput \"PublicSubnet3ID\" {\n    description = \" Public subnet 3 ID in Availability Zone 3\"\n    value = module.quickstart_vpc.PublicSubnet3ID\n  }\n\noutput \"PublicSubnet4CIDR\" {\n    description = \" Public subnet 4 CIDR in Availability Zone 4\"\n    value = module.quickstart_vpc.PublicSubnet4CIDR\n  }\n\noutput \"PublicSubnet4ID\" {\n    description = \" Public subnet 4 ID in Availability Zone 4\"\n    value = module.quickstart_vpc.PublicSubnet4ID\n  }\n\noutput \"DynamoDBVPCEndpoint\" {\n    description = \" Dynamo DB VPC Endpoint\"\n    value = module.quickstart_vpc.DynamoDBVPCEndpoint\n  }\noutput \"PrivateSubnet1ARouteTable\" {\n    description = \" Private subnet 1A route table\"\n    value = module.quickstart_vpc.PrivateSubnet1ARouteTable\n  }\n\noutput \"PrivateSubnet2ARouteTable\" {\n    description = \" Private subnet 2A route table\"\n    value = module.quickstart_vpc.PrivateSubnet2ARouteTable\n  }\n\noutput \"PrivateSubnet3ARouteTable\" {\n    description = \" Private subnet 3A route table\"\n    value = module.quickstart_vpc.PrivateSubnet3ARouteTable\n  }\n\noutput \"PrivateSubnet4ARouteTable\" {\n    description = \" Private subnet 4A route table\"\n    value = module.quickstart_vpc.PrivateSubnet4ARouteTable\n  }\n\noutput  \"PublicSubnetRouteTable\" {\n    description = \" Public subnet route table\"\n    value = module.quickstart_vpc.PublicSubnetRouteTable\n  }\n\n####\n#Fargate\n#\n###\n\noutput \"user_instructions\" {\n  value = <<README\nTo connect to your fargate container use the following public LB dns address\n\nhttp://${module.fargate.Public_LB_DNS_name}\nREADME\n}",
    "setup_env/workspace.tf": "###########\n# Defaults\n##########\nterraform {\n  required_version = \">= 0.13\"\n\n}\n\nresource \"random_pet\" \"name\" {\n  prefix = \"aws-quickstart\"\n  length = 1\n}\n\nresource \"tfe_organization\" \"quickstart-org\" {\n  name  = random_pet.name.id\n  email = \"admin@your-company.com\"\n}\n\nresource \"tfe_workspace\" \"quickstart-workspace-1\" {\n  name         = \"${random_pet.name.id}-workspace-1\"\n  organization = tfe_organization.quickstart-org.name\n  working_directory = \"./deploy_Publicly_Exposed_Service_with_Private_Networking\"\n}\nresource \"tfe_variable\" \"AWS_SECRET_ACCESS_KEY\" {\n  key          = \"AWS_SECRET_ACCESS_KEY\"\n  value        = \"\"\n  sensitive    = true\n  category     = \"env\"\n  workspace_id = tfe_workspace.quickstart-workspace-1.id\n  description  = \"AWS_SECRET_ACCESS_KEY\"\n}\nresource \"tfe_variable\" \"AWS_ACCESS_KEY_ID\" {\n  key          = \"AWS_ACCESS_KEY_ID\"\n  value        = \"\"\n  category     = \"env\"\n  workspace_id = tfe_workspace.quickstart-workspace-1.id\n  description  = \"AWS_ACCESS_KEY_ID\"\n}\n\nresource  \"null_resource\" \"backend_file\" {\n  depends_on = [tfe_workspace.quickstart-workspace-1]\n  provisioner \"local-exec\" {\n  command =  \"echo  workspaces '{' name = \\\\\\\"${tfe_workspace.quickstart-workspace-1.name}\\\\\\\" '}' >> ../deploy_Publicly_Exposed_Service_with_Private_Networking/backend.hcl\"\n  }\n  provisioner \"local-exec\" {\n  command =  \"echo hostname = \\\\\\\"app.terraform.io\\\\\\\" >> ../deploy_Publicly_Exposed_Service_with_Private_Networking/backend.hcl\"\n  }\n  provisioner \"local-exec\" {\n  command =  \"echo  organization = \\\\\\\"${tfe_organization.quickstart-org.name}\\\\\\\" >> ../deploy_Publicly_Exposed_Service_with_Private_Networking/backend.hcl\"\n  }\n}\n\nresource  \"null_resource\" \"remote_init\" {\n  depends_on = [null_resource.backend_file]\n  provisioner \"local-exec\" {\n  working_dir = \"../deploy_Publicly_Exposed_Service_with_Private_Networking\"\n  command =  \"terraform init -backend-config=backend.hcl\"\n  }\n}\n\n\noutput \"user_instructions\" {\n  value = <<README\n\n your org name        = ${tfe_organization.quickstart-org.name}\n your workspace for new vpc is      = ${tfe_workspace.quickstart-workspace-1.name}\n# Run these commands in order:\n#    cd ../deploy_Publicly_Exposed_Service_with_Private_Networking\n#then\n#    terraform apply\nREADME\n}",
    "modules/bastion/main.tf": "terraform {\n  required_version = \">= 0.13\"\n\n}\n\n\ndata \"aws_availability_zones\" \"available\" {\n  state = \"available\"\n}\n\ndata \"aws_vpc\" \"vpc\" {\n  filter {\n    name   = \"tag:Name\"\n    values = [\"${var.name}_vpc\"]\n  }\n}\n\ndata \"aws_subnet_ids\" \"private\" {\n  vpc_id = data.aws_vpc.vpc.id\nfilter {\n    name   = \"tag:Name\"\n    values = [\"${var.name}_public_subnets\"] \n  }\n}\n\ndata \"aws_security_groups\" \"public\" {\n   filter {\n    name   = \"vpc-id\"\n    values = [data.aws_vpc.vpc.id]\n  }\n  filter {\n    name   = \"group-name\"\n    values = [\"default\"] \n  }\n}\n\ndata \"aws_security_group\" \"public\" {\n   filter {\n    name   = \"vpc-id\"\n    values = [data.aws_vpc.vpc.id]\n  }\n  filter {\n    name   = \"group-name\"\n    values = [\"default\"] \n  }\n}\n\ndata \"aws_ami\" \"amazon_linux\" {\n  most_recent = true\n  owners      = [\"amazon\"]\n\n  filter {\n    name = \"name\"\n\n    values = [\n      \"amzn-ami-hvm-*-x86_64-gp2\",\n    ]\n  }\n\n  filter {\n    name = \"owner-alias\"\n\n    values = [\n      \"amazon\",\n    ]\n  }\n}\n\nresource \"random_id\" \"name\" {\n  byte_length = 4\n  prefix      = \"tls-private-key-\"\n}\n\nresource \"tls_private_key\" \"key\" {\n  algorithm   = \"RSA\"\n  rsa_bits    = \"2048\"\n}\n\nresource \"aws_key_pair\" \"main\" {\n  key_name_prefix = random_id.name.hex\n  public_key      = tls_private_key.key.public_key_openssh\n}\n\nresource \"aws_security_group_rule\" \"ssh\" {\n  count = var.create_bastion ? 1 : 0\n  type              = \"ingress\"\n  from_port         = 0\n  to_port           = 22\n  protocol          = \"tcp\"\n  cidr_blocks       = [\"0.0.0.0/0\"]\n  security_group_id = data.aws_security_group.public.id\n}\n\n\nresource \"aws_launch_template\" \"bastion\" {\n\n  name_prefix   = \"bastion\"\n  image_id      = data.aws_ami.amazon_linux.id\n  instance_type = \"t2.micro\"\n  vpc_security_group_ids = data.aws_security_groups.public.ids\n  key_name = var.key_name == \"\"  ? aws_key_pair.main.id : var.key_name\n}\nresource \"aws_autoscaling_group\" \"bastion\" {\n  count = var.create_bastion ? 1 : 0\n  vpc_zone_identifier  = data.aws_subnet_ids.private.ids\n  desired_capacity   = 2\n  max_size           = 5\n  min_size           = 2\n\n  launch_template {\n    id      = aws_launch_template.bastion.id\n    version = \"$Latest\"\n  }\n}\n\noutput \"private_key_pem\" {\n  value = tls_private_key.key.private_key_pem\n}",
    "modules/bastion/variables.tf": "# ---------------------------------------------------------------------------------------------------------------------\n# PARAMETERS\n# These parameters have reasonable defaults.\n# ---------------------------------------------------------------------------------------------------------------------\nvariable \"region\" {\n  type        = string\n  description = \"The name of the region you wish to deploy into\"\n  default     = \"us-east-1\"\n}\n\nvariable \"name\" {\n  description = \"Name given resources\"\n  type        = string\n  default     = \"aws-quickstart\"\n}\n\nvariable \"create_bastion\" {\n  description = \"Create resource\"\n  type        = bool\n  default     = true\n}\n\nvariable \"key_name\" {\n  type = string\n  description = \"ssh key name\"\n}",
    "modules/fargate/main.tf": "######\n# Collect data\n######\n\ndata \"aws_availability_zones\" \"available\" {\n  state = \"available\"\n}\n\ndata \"aws_vpc\" \"vpc\" {\n  filter {\n    name   = \"tag:Name\"\n    values = [\"${var.name}_vpc\"]\n  }\n}\n\ndata \"aws_subnet_ids\" \"public\" {\n  vpc_id = data.aws_vpc.vpc.id\nfilter {\n    name   = \"tag:Name\"\n    values = [\"${var.name}_public_subnets\"] \n  }\n}\n\ndata \"aws_subnet_ids\" \"private\" {\n  vpc_id = data.aws_vpc.vpc.id\nfilter {\n    name   = \"tag:Name\"\n    values = [\"${var.name}_private_subnets_A\"] \n  }\n}\n\nresource \"aws_iam_role\" \"ECSTaskExecutionRole\" {\n  name = var.name\n\n  # Terraform's \"jsonencode\" function converts a\n  # Terraform expression result to valid JSON syntax.\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"ecs-tasks.amazonaws.com\"\n        }\n      },\n    ]\n  })\n\n   tags = {\n    Environment = \"aws-quickstarts-fargate\"\n  }\n}\n\n# ######\n# # Security Groups\n# ######\nresource \"aws_security_group\" \"fargate_container_sg\" {\n  description = \"Allow access to the public facing load balancer\"\n  vpc_id      = data.aws_vpc.vpc.id\n\n  ingress {\n    description = \"Ingress from the public ALB\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n    \n  }\n  ingress {\n    description = \"Ingress from the private ALB\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    \n  }\n  ingress {\n    description = \"Ingress from other containers in the same security group\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    \n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"aws-quickstarts-fargate-container-sg\"\n  }\n}\n\n######\n# ECS\n######\n\nresource \"aws_ecs_cluster\" \"ECS_Fargate\" {\n  name = var.name\n}\n\nresource \"aws_ecs_task_definition\" \"ECS_task\" {\n  family = var.ServiceName\n  cpu = var.ContainerCpu\n  memory =var.ContainerMemory\n  requires_compatibilities = [\"FARGATE\"]\n  network_mode = \"awsvpc\"\n  execution_role_arn = aws_iam_role.ECSTaskExecutionRole.arn\n\n\n  container_definitions = jsonencode(\n[\n  {\n    \"cpu\": var.ContainerCpu,\n    \"image\": var.ImageUrl,\n    \"memory\": var.ContainerMemory,\n    \"name\": var.ServiceName\n    \"portMappings\": [\n      {\n        \"containerPort\": var.ContainerPort,\n      }\n    ]\n  }\n])\n}\n\nresource \"aws_ecs_service\" \"ECS_service\" {\n depends_on = [aws_lb.public]\n  name          = var.name\n  cluster       = aws_ecs_cluster.ECS_Fargate.id\n  launch_type = \"FARGATE\"\n  deployment_maximum_percent = \"200\"\n  deployment_minimum_healthy_percent  = \"75\"\n  desired_count = var.DesiredCount\n  network_configuration {\n      subnets = data.aws_subnet_ids.private.ids\n      security_groups = [aws_security_group.fargate_container_sg.id]\n  }\n  # Track the latest ACTIVE revision\n  task_definition = \"${aws_ecs_task_definition.ECS_task.family}:${max(aws_ecs_task_definition.ECS_task.revision, aws_ecs_task_definition.ECS_task.revision)}\"\n\nload_balancer {\n    target_group_arn = aws_lb_target_group.target_group_public.arn\n    container_name   = var.ServiceName\n    container_port   = var.ContainerPort\n  }\n}\n\n######\n# Set up public load balancer\n######\nresource \"aws_security_group\" \"public_lb_access\" {\n  description = \"Allow access to the public facing load balancer\"\n  vpc_id      = data.aws_vpc.vpc.id\n\n  ingress {\n    description = \"allow public access to fargate ECS\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"aws-quickstarts-fargate\"\n  }\n}\n\nresource \"aws_lb\" \"public\" {\n  name               = \"${var.name}-pub-lb\"\n  internal           = false\n  load_balancer_type = \"application\"\n  idle_timeout       = \"30\"\n  security_groups    = [aws_security_group.public_lb_access.id]\n  subnets            = data.aws_subnet_ids.public.ids\n  tags = {\n    Environment = \"aws-quickstarts-fargate\"\n  }\n}\n\nresource \"aws_lb_listener\" \"public_listener\" {\n  load_balancer_arn = aws_lb.public.arn\n  port              = \"80\"\n  protocol          = \"HTTP\"\n\n  default_action {\n    type             = \"forward\"\n    target_group_arn = aws_lb_target_group.target_group_public.arn\n  }\n}\n\nresource \"aws_lb_listener_rule\" \"public\" {\n  listener_arn = aws_lb_listener.public_listener.arn\n  priority     = var.Priority\n\n  action {\n    type             = \"forward\"\n    target_group_arn = aws_lb_target_group.target_group_public.arn\n  }\n\n  condition {\n    path_pattern {\n      values = [var.Path]\n    }\n  }\n}\n\n######\n# Set up private load balancer\n###### \n\nresource \"aws_security_group\" \"private_lb_access\" {\n  description = \"Only accept traffic from a container in the fargate container security group\"\n  vpc_id      = data.aws_vpc.vpc.id\n\n  ingress {\n    description = \"allow private access to fargate ECS\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    security_groups = [aws_security_group.fargate_container_sg.id]\n  }\n egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"aws-quickstarts-fargate\"\n  }\n}\n\nresource \"aws_lb\" \"private\" {\n  name               = \"${var.name}-pri-lb\"\n  internal           = true\n  load_balancer_type = \"application\"\n  idle_timeout       = \"30\"\n  security_groups    = [aws_security_group.private_lb_access.id]\n  subnets            = data.aws_subnet_ids.private.ids\n  tags = {\n    Environment = \"aws-quickstarts-fargate\"\n  }\n}\nresource \"aws_lb_listener\" \"private_listener\" {\n  load_balancer_arn = aws_lb.private.arn\n  port              = \"80\"\n  protocol          = \"HTTP\"\n\n  default_action {\n    type             = \"forward\"\n    target_group_arn = aws_lb_target_group.target_group_private.arn\n  }\n}\n\nresource \"aws_lb_listener_rule\" \"private\" {\n  listener_arn = aws_lb_listener.private_listener.arn\n  priority     = var.Priority\n\n  action {\n    type             = \"forward\"\n    target_group_arn = aws_lb_target_group.target_group_private.arn\n  }\n\n  condition {\n    path_pattern {\n      values = [var.Path]\n    }\n  }\n}\n\n######\n# Route traffic to the containers via traffic groups\n######\n\nresource \"aws_lb_target_group\" \"target_group_public\" {\n  name        = \"${var.name}-pub-tg\"\n  port        = var.ContainerPort\n  protocol    = \"HTTP\"\n  target_type = \"ip\"\n  health_check {\n      path = \"/\"\n      protocol    = \"HTTP\"\n      port        = var.ContainerPort\n      timeout = \"5\"\n      healthy_threshold = \"2\"\n      interval =\"6\"\n  }\n  vpc_id      = data.aws_vpc.vpc.id\n  \n}\n\nresource \"aws_lb_target_group\" \"target_group_private\" {\n  name        = \"${var.name}-pri-tg\"\n  port        = var.ContainerPort\n  protocol    = \"HTTP\"\n  target_type = \"ip\"\n  health_check {\n      path = \"/\"\n      protocol    = \"HTTP\"\n      port        = var.ContainerPort\n      timeout = \"5\"\n      healthy_threshold = \"2\"\n      interval =\"6\"\n  }\n  vpc_id      = data.aws_vpc.vpc.id\n  \n}",
    "modules/fargate/outputs.tf": "output \"Public_LB_DNS_name\" {\n  description = \"Public LB address to connect too\"\n  value = aws_lb.public.dns_name\n}",
    "modules/fargate/variables.tf": "\nvariable \"region\" {\n  type        = string\n  description = \"the name of the region you wish to deploy into\"\n  default     = \"us-east-1\"\n}\n\nvariable \"name\" {\n  description = \"Name given resources\"\n  type        = string\n  default     = \"aws-quickstart\"\n}\n\nvariable \"ServiceName\" {\n    type = string\n    default = \"nginx\"\n    description =  \"A name for the service\"\n}\n\nvariable \"ImageUrl\" {\n    type = string\n    default = \"nginx\"\n    description = \"the url of a docker image that contains the application process that will handle the traffic for this service\"\n}\n\nvariable \"ContainerPort\" {\n    type = number\n    default = 80\n    description = \"What port number the application inside the docker container is binding to\"\n}\n\nvariable \"ContainerCpu\" {\n    type = number\n    default = 256\n    description = \"How much CPU to give the container. 1024 is 1 CPU\"\n}\n\nvariable \"ContainerMemory\" {\n    type = number\n    default = 512\n    description = \"How much memory in megabytes to give the container\"\n}\n\nvariable \"Path\" {\n    type = string\n    default = \"*\"\n    description = \"A path on the public load balancer that this service should be connected to. Use * to send all load balancer traffic to this service.\"\n}\n\nvariable \"Priority\" {\n    type = number\n    default = 1\n    description = \"The priority for the routing rule added to the load balancer. This only applies if your have multiple services which have been assigned to different paths on the load balancer.\"\n}\n\nvariable \"DesiredCount\" {\n    type = number\n    default = 2\n    description = \"How many copies of the service task to run\"\n}",
    "modules/quickstart_vpc/main.tf": "###########\n# Defaults\n##########\n\nterraform {\n  required_version = \">= 0.13\"\n\n}\n# ---------------------------------------------------------------------------------------------------------------------\n# Set the AWS REGION\n# ---------------------------------------------------------------------------------------------------------------------\n\nprovider \"aws\" {\n  region = var.region\n}\n\n######\n# Collect data\n######\n\ndata \"aws_availability_zones\" \"available\" {\n  state = \"available\"\n}\n\n\n######\n# VPC\n######\nresource \"aws_vpc\" \"main\" {\n  cidr_block                       = var.cidr\n  instance_tenancy                 = var.instance_tenancy\n  enable_dns_hostnames             = var.enable_dns_hostnames\n  enable_dns_support               = var.enable_dns_support\n\n  tags = {\n    Terraform = \"true\"\n    Name      = \"${var.name}_vpc\"\n  }\n}\n\nresource \"aws_vpc_endpoint\" \"dynamodb\" {\n  vpc_id       = aws_vpc.main.id\n  service_name = \"com.amazonaws.${var.region}.dynamodb\"\n \n  tags = {\n    Terraform = \"true\"\n    Name      = \"${var.name}_vpc_endpoint\"\n  }\n}\n\nresource \"aws_vpc_endpoint_route_table_association\" \"private_A\" {\n  count = 2\n\n  route_table_id  = aws_route_table.private_A[count.index].id\n  vpc_endpoint_id = aws_vpc_endpoint.dynamodb.id\n}\n\n###################\n# Internet Gateway\n###################\nresource \"aws_internet_gateway\" \"gw\" {\n  vpc_id = aws_vpc.main.id\n\n  tags = {\n    Name = \"${var.name}_iGW\"\n  }\n\n}\n\n################\n# Publi\u0441 routes\n################\nresource \"aws_route_table\" \"public\" {\n  vpc_id = aws_vpc.main.id\n\n tags = {\n    Name = \"${var.name}_public_routes\"\n  }\n\n}\n\nresource \"aws_route\" \"public_internet_gateway\" {\n  route_table_id         = aws_route_table.public.id\n  destination_cidr_block = \"0.0.0.0/0\"\n  gateway_id             = aws_internet_gateway.gw.id\n\n  timeouts {\n    create = \"5m\"\n  }\n}\n\n#################\n# Private routes A\n# There are as many routing tables as the number of NAT gateways\n#################\nresource \"aws_route_table\" \"private_A\" {\n  count = 2\n  vpc_id = aws_vpc.main.id\n\n tags = {\n    Name = \"${var.name}_private_routes_A\"\n  }\n}\n\n################\n# Public subnet\n################\nresource \"aws_subnet\" \"public\" {\n  count = 2\n  vpc_id                          = aws_vpc.main.id\n  cidr_block                      = var.public_subnets[count.index]\n  availability_zone               = data.aws_availability_zones.available.names[count.index]\n  map_public_ip_on_launch         = true \n\ntags = {\n    Name = \"${var.name}_public_subnets\"\n  }\n}\n\n#################\n# Private subnet A\n#################\nresource \"aws_subnet\" \"private_A\" {\n  count = 2\n  vpc_id                          = aws_vpc.main.id\n  cidr_block                      = var.private_subnets_A[count.index]    \n  availability_zone               = data.aws_availability_zones.available.names[count.index]\n\n tags = {\n    Name = \"${var.name}_private_subnets_A\"\n  }\n}\n\n\n########################\n# Shared Default Network ACLs\n########################\nresource \"aws_network_acl\" \"public\" {\n  vpc_id     = aws_vpc.main.id\n  subnet_ids = concat(aws_subnet.private_A.*.id, aws_subnet.public.*.id)\n\n  tags = {\n    Name = \"${var.name}_shared_default_nework_acl\"\n  }\n}\n\nresource \"aws_network_acl_rule\" \"public_inbound\" {\n  network_acl_id = aws_network_acl.public.id\n\n  egress          = false\n  rule_number     = var.public_inbound_acl_rules[0][\"rule_number\"]\n  rule_action     = var.public_inbound_acl_rules[0][\"rule_action\"]\n  from_port       = lookup(var.public_inbound_acl_rules[0], \"from_port\", null)\n  to_port         = lookup(var.public_inbound_acl_rules[0], \"to_port\", null)\n  icmp_code       = lookup(var.public_inbound_acl_rules[0], \"icmp_code\", null)\n  icmp_type       = lookup(var.public_inbound_acl_rules[0], \"icmp_type\", null)\n  protocol        = var.public_inbound_acl_rules[0][\"protocol\"]\n  cidr_block      = lookup(var.public_inbound_acl_rules[0], \"cidr_block\", null)\n}\n\nresource \"aws_network_acl_rule\" \"public_outbound\" {\n  network_acl_id = aws_network_acl.public.id\n\n  egress          = true\n  rule_number     = var.public_outbound_acl_rules[0][\"rule_number\"]\n  rule_action     = var.public_outbound_acl_rules[0][\"rule_action\"]\n  from_port       = lookup(var.public_outbound_acl_rules[0], \"from_port\", null)\n  to_port         = lookup(var.public_outbound_acl_rules[0], \"to_port\", null)\n  icmp_code       = lookup(var.public_outbound_acl_rules[0], \"icmp_code\", null)\n  icmp_type       = lookup(var.public_outbound_acl_rules[0], \"icmp_type\", null)\n  protocol        = var.public_outbound_acl_rules[0][\"protocol\"]\n  cidr_block      = lookup(var.public_outbound_acl_rules[0], \"cidr_block\", null)\n}\n\n##############\n# NAT Gateway\n##############\n\nresource \"aws_eip\" \"nat\" {\n  count = 2\n  vpc = true\n\ntags = {\n    Name = \"${var.name}_EIP_nat\"\n  }\n}\n\nresource \"aws_nat_gateway\" \"nat_gw\" {\n  count = 2\n  allocation_id = aws_eip.nat[count.index].id\n  subnet_id = aws_subnet.public[count.index].id\n\ntags = {\n    Name = \"${var.name}_EIP_nat_gateway\"\n  }\n  depends_on = [aws_internet_gateway.gw]\n}\n\nresource \"aws_route\" \"private_A_nat_gateway\" {\n  count = 2\n  route_table_id         = aws_route_table.private_A[count.index].id\n  destination_cidr_block = \"0.0.0.0/0\"\n  nat_gateway_id         = aws_nat_gateway.nat_gw[count.index].id\n\n  timeouts {\n    create = \"5m\"\n  }\n}\n\n##########################\n# Route table association\n##########################\nresource \"aws_route_table_association\" \"private_A\" {\n  count = 2\n  subnet_id = aws_subnet.private_A[count.index].id\n  route_table_id = aws_route_table.private_A[count.index].id\n}\n\nresource \"aws_route_table_association\" \"public\" {\n count = 2\n subnet_id = aws_subnet.public[count.index].id\n route_table_id = aws_route_table.public.id\n}\n",
    "modules/quickstart_vpc/outputs.tf": "# VPC\noutput \"vpc_cidr\" {\n  description = \"VPC_CIDR \"\n  value       = aws_vpc.main.cidr_block\n}\noutput  \"vpc_id\" {\n  description = \"The ID of the VPC\"\n  value       = aws_vpc.main.id\n}\noutput \"NAT1EIP\" {\n    description = \"NAT 1 IP address\"\n    value = aws_eip.nat[0].public_ip\n}\n\noutput \"NAT2EIP\" {\n    description = \" NAT 2 IP address\"\n    value =  aws_eip.nat[1].public_ip\n  }\n\noutput \"NAT3EIP\" {\n    description = \" NAT 3 IP address\"\n    value =  length(aws_eip.nat.*.public_ip) > 2 ? aws_eip.nat[2].public_ip : null\n  }\n\noutput \"NAT4EIP\" {\n    description = \" NAT 4 IP address\"\n    value = length(aws_eip.nat.*.public_ip) > 3 ? aws_eip.nat[3].public_ip : null\n  }\n\noutput \"PrivateSubnet1ACIDR\" {\n    description = \" Private subnet 1A CIDR in Availability Zone 1\"\n    value = aws_subnet.private_A[0].cidr_block\n  }\n\noutput \"PrivateSubnet1AID\" {\n    description = \" Private subnet 1A ID in Availability Zone 1\"\n    value =  aws_subnet.private_A[0].id\n  }\n\noutput \"PrivateSubnet2ACIDR\" {\n    description = \" Private subnet 2A CIDR in Availability Zone 2\"\n    value = aws_subnet.private_A[1].cidr_block\n  }\n\noutput \"PrivateSubnet2AID\" {\n    description = \" Private subnet 2A ID in Availability Zone 2\"\n    value = aws_subnet.private_A[1].id\n  }\n\noutput \"PrivateSubnet3ACIDR\" {\n    description = \" Private subnet 3A CIDR in Availability Zone 3\"\n    value = length(aws_subnet.private_A.*.cidr_block) > 2 ? aws_subnet.private_A[2].cidr_block : null\n  }\n\noutput \"PrivateSubnet3AID\" {\n    description = \" Private subnet 3A ID in Availability Zone 3\"\n    value = length(aws_subnet.private_A.*.id) > 2 ? aws_subnet.private_A[2].id : null\n  }\n\noutput \"PrivateSubnet4ACIDR\" {\n    description = \" Private subnet 4A CIDR in Availability Zone 4\"\n    value = length(aws_subnet.private_A.*.cidr_block) > 3 ? aws_subnet.private_A[3].cidr_block : null\n  }\n\noutput \"PrivateSubnet4AID\" {\n    description = \" Private subnet 4A ID in Availability Zone 4\"\n    value = length(aws_subnet.private_A.*.id) > 3 ? aws_subnet.private_A[3].id : null\n  }\n\noutput \"PublicSubnet1CIDR\" {\n    description = \" Public subnet 1 CIDR in Availability Zone 1\"\n    value = aws_subnet.public[0].cidr_block\n  }\n\noutput \"PublicSubnet1ID\" {\n    description = \" Public subnet 1 ID in Availability Zone 1\"\n    value = aws_subnet.public[0].id\n  }\n\noutput \"PublicSubnet2CIDR\" {\n    description = \" Public subnet 2 CIDR in Availability Zone 2\"\n    value =  aws_subnet.public[1].cidr_block\n  }\n\noutput \"PublicSubnet2ID\" {\n    description = \" Public subnet 2 ID in Availability Zone 2\"\n    value = aws_subnet.public[1].id\n  }\n\noutput \"PublicSubnet3CIDR\" {\n    description = \" Public subnet 3 CIDR in Availability Zone 3\"\n    value = length(aws_subnet.public.*.cidr_block) > 2 ? aws_subnet.public[2].cidr_block : null\n  }\n\noutput \"PublicSubnet3ID\" {\n    description = \" Public subnet 3 ID in Availability Zone 3\"\n    value = length(aws_subnet.public.*.id) > 2 ? aws_subnet.public[2].id : null\n  }\n\noutput \"PublicSubnet4CIDR\" {\n    description = \" Public subnet 4 CIDR in Availability Zone 4\"\n    value = length(aws_subnet.public.*.cidr_block) > 3 ? aws_subnet.public[3].cidr_block : null\n  }\n\noutput \"PublicSubnet4ID\" {\n    description = \" Public subnet 4 ID in Availability Zone 4\"\n    value = length(aws_subnet.public.*.id) > 3 ? aws_subnet.public[3].id : null\n  }\n\noutput \"DynamoDBVPCEndpoint\" {\n    description = \" Dynamo DB VPC Endpoint\"\n    value = aws_vpc_endpoint.dynamodb.*.id\n  }\n\noutput \"PrivateSubnet1ARouteTable\" {\n    description = \" Private subnet 1A route table\"\n    value = aws_route_table.private_A[0].id\n  }\n\noutput \"PrivateSubnet2ARouteTable\" {\n    description = \" Private subnet 2A route table\"\n    value = aws_route_table.private_A[1].id\n  }\n\noutput \"PrivateSubnet3ARouteTable\" {\n    description = \" Private subnet 3A route table\"\n    value = length(aws_route_table.private_A.*.id ) > 2 ? aws_route_table.private_A[2].id  : null \n  }\n\noutput \"PrivateSubnet4ARouteTable\" {\n    description = \" Private subnet 4A route table\"\n    value = length(aws_route_table.private_A.*.id ) > 3 ? aws_route_table.private_A[3].id  : null \n  }\n\noutput  \"PublicSubnetRouteTable\" {\n    description = \" Public subnet route table\"\n    value = aws_route_table.public.*.id\n  }",
    "modules/quickstart_vpc/variables.tf": "\n# ---------------------------------------------------------------------------------------------------------------------\n# PARAMETERS\n# These parameters have reasonable defaults.\n# ---------------------------------------------------------------------------------------------------------------------\nvariable \"region\" {\n  type        = string\n  description = \"The name of the region you wish to deploy into\"\n  default     = \"us-east-1\"\n}\n\nvariable \"name\" {\n  description = \"Name given resources\"\n  type        = string\n  default     = \"aws-quickstart\"\n}\n\nvariable \"enable_dns_hostnames\" {\n  description = \"Should be true to enable DNS hostnames in the VPC\"\n  type        = bool\n  default     = true\n}\n\nvariable \"enable_dns_support\" {\n  description = \"Should be true to enable DNS support in the VPC\"\n  type        = bool\n  default     = true\n}\n\nvariable \"instance_tenancy\" {\n  description = \"A tenancy option for instances launched into the VPC\"\n  type        = string\n  default     = \"default\"\n}\n\nvariable \"cidr\" {\n  description = \"The CIDR block for the VPC. Default value is a valid CIDR, but not acceptable by AWS and should be overridden\"\n  type        = string \n  default     = \"10.0.0.0/16\"\n}\n\nvariable \"public_subnets\" {\n  description = \"A list of private subnets inside the VPC\"\n  type        = list(string)\n  default     = [\"10.0.0.0/24\", \"10.0.1.0/24\"]\n}\n\nvariable \"private_subnets_A\" {\n  description = \"A list of private subnets inside the VPC\"\n  type        = list(string)\n  default     = [\"10.0.2.0/24\", \"10.0.3.0/24\"]\n}\n\nvariable \"private_subnets_B\" {\n  description = \"A list of private subnets inside the VPC\"\n  type        = list(string)\n  default     = [\"10.0.192.0/21\", \"10.0.200.0/21\", \"10.0.208.0/21\", \"10.0.216.0/21\",\"10.0.224.0/22\", \"10.0.228.0/22\"]\n}\n\nvariable \"public_inbound_acl_rules\" {\n  description = \"Public subnets inbound network ACLs\"\n  type        = list(map(string))\n\n  default = [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ]\n}\n\nvariable \"public_outbound_acl_rules\" {\n  description = \"Public subnets outbound network ACLs\"\n  type        = list(map(string))\n\n  default = [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ]\n}\n\nvariable \"custom_inbound_acl_rules\" {\n  description = \"Custom subnets inbound network ACLs\"\n  type        = list(map(string))\n\n  default = [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ]\n}\n\nvariable \"custom_outbound_acl_rules\" {\n  description = \"Custom subnets outbound network ACLs\"\n  type        = list(map(string))\n\n  default = [\n    {\n      rule_number = 100\n      rule_action = \"allow\"\n      from_port   = 0\n      to_port     = 0\n      protocol    = \"-1\"\n      cidr_block  = \"0.0.0.0/0\"\n    },\n  ]\n}"
  }
}